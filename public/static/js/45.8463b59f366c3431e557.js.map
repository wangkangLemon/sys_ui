{"version":3,"sources":["webpack:///static/js/45.8463b59f366c3431e557.js","webpack:///./src/views/base/login/TwiceValid.vue","webpack:///./src/vendor/wechatSdk.js?acbd","webpack:///TwiceValid.vue","webpack:///./src/services/base/twoStepService.js","webpack:///./src/views/base/login/TwiceValid.vue?e85b","webpack:///./src/views/base/login/TwiceValid.vue?db30","webpack:///./src/views/base/login/TwiceValid.vue?c870"],"names":["webpackJsonp","157","module","exports","__webpack_require__","Component","432","__webpack_exports__","Promise","currMsgListener","wechatSdk","initLogin","wechatConfig","resolve","reject","window","WxLogin","script","document","createElement","src","head","appendChild","onload","then","Object","assign","style","href","redirect_uri","encodeURIComponent","catch","err","buildUrl","_ref","appid","scope","state","openWechatLogin","_ref2","callback","verify","removeEventListener","replace","tab","open","e","data","close","addEventListener","call","745","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0__vendor_wechatSdk__","__WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__","__WEBPACK_IMPORTED_MODULE_2__utils_authUtils__","loadingdata","wechat","email","sms","user","codeWaitSecond","smsCode","emailCode","tabSelected","logining","created","ret","this","$route","query","JSON","parse","code","setTwiceToken","adminTwoStepAuthToken","$router","name","xmview","showTip","message","getUserInfo","mounted","_this","getSafeSetInfo","location","id","$nextTick","beforeDestroy","closeAllTip","methods","sendValidCode","type","_this2","p","sendSmsValidcode","sendEmailValidcode","intervalId","setInterval","clearInterval","login","_this3","twiceSmsValid","twiceEmailValid","item","getNavMenu","children","length","push","path","menu_url","setTimeout","components","808","_classCallCheck","instance","Constructor","TypeError","__WEBPACK_IMPORTED_MODULE_0__api__","__WEBPACK_IMPORTED_MODULE_1__utils_config__","_createClass","defineProperties","target","props","i","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","urlPre","apiHost","TwoStepService","url","userTwoStepAuthToken","823","version","sources","names","mappings","file","sourcesContent","sourceRoot","878","content","locals","951","render","_vm","_h","$createElement","_c","_self","directives","rawName","expression","attrs","_v","_s","on","click","$event","staticClass","slot","label","_e","placeholder","nativeOn","keyup","_k","keyCode","model","$$v","disabled","staticRenderFns"],"mappings":"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","file":"static/js/45.8463b59f366c3431e557.js","sourcesContent":["webpackJsonp([45],{\n\n/***/ 157:\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(878)\n\nvar Component = __webpack_require__(10)(\n  /* script */\n  __webpack_require__(745),\n  /* template */\n  __webpack_require__(951),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 432:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__utils_config__ = __webpack_require__(4);\n/**\n * Created by huanghuixin on 2017/4/13.\n */\n\n\nvar _currMsgListener = void 0;\nvar wechatSdk = {\n    // 初始化二维码\n    initLogin: function initLogin(wechatConfig) {\n        return new Promise(function (resolve, reject) {\n            if (window.WxLogin) {\n                resolve(true);\n                return;\n            }\n\n            var script = document.createElement('script');\n            script.src = '//res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js';\n            document.head.appendChild(script);\n            script.onload = function () {\n                resolve(true);\n            };\n        }).then(function () {\n            // mine/two-step/wechat/callback?verify=\n            wechatConfig = Object.assign({}, wechatConfig, {\n                style: 'white',\n                href: ''\n            });\n\n            wechatConfig.redirect_uri = encodeURIComponent(wechatConfig.redirect_uri);\n            return new window.WxLogin(wechatConfig);\n        }).catch(function (err) {\n            console.info('微信二维码初始化失败', err);\n        });\n    },\n    buildUrl: function buildUrl(_ref) {\n        var appid = _ref.appid,\n            scope = _ref.scope,\n            redirect_uri = _ref.redirect_uri,\n            state = _ref.state;\n\n        // config.debug && (redirect_uri = 'http://sys.yst.vodjk.com/mine/two-step/wechat/callback?verify=1')\n        return 'https://open.weixin.qq.com/connect/qrconnect?state=' + state + '&appid=' + appid + '&scope=' + scope + '&redirect_uri=' + encodeURIComponent(redirect_uri) + '&login_type=jssdk&style=white';\n    },\n    openWechatLogin: function openWechatLogin(_ref2, callback) {\n        var appid = _ref2.appid,\n            scope = _ref2.scope,\n            redirect_uri = _ref2.redirect_uri,\n            state = _ref2.state,\n            verify = _ref2.verify;\n\n        // 先移除事件\n        _currMsgListener && window.removeEventListener('message', _currMsgListener);\n\n        if (verify) redirect_uri = redirect_uri.replace('verify=', 'verify=' + verify);\n\n        // 打开登录tab\n        var tab = window.open(wechatSdk.buildUrl({ appid: appid, scope: scope, redirect_uri: redirect_uri, state: state }));\n        // 回调事件\n        _currMsgListener = function currMsgListener(e) {\n            callback(e.data);\n            tab.close();\n            window.removeEventListener('message', _currMsgListener);\n            tab = null;\n            _currMsgListener = null;\n        };\n        window.addEventListener('message', _currMsgListener, false);\n    }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (wechatSdk);\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(7)))\n\n/***/ }),\n\n/***/ 745:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__vendor_wechatSdk__ = __webpack_require__(432);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__ = __webpack_require__(808);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__utils_authUtils__ = __webpack_require__(5);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    data: function data() {\n        return {\n            loadingdata: false,\n            wechat: void 0,\n            email: void 0,\n            sms: void 0,\n            wechatConfig: void 0,\n            user: {},\n            codeWaitSecond: 0, // 验证码发送后的等待时间 -1表示不可用 比如正在请求发送验证码接口\n            smsCode: void 0,\n            emailCode: void 0,\n            tabSelected: 'first', // 选中的tab\n            logining: false // 正在登录请求的状态\n        };\n    },\n    created: function created() {\n        var ret = this.$route.query.callback ? JSON.parse(this.$route.query.callback) : void 0;\n\n        if (ret && ret.code == 0) {\n            __WEBPACK_IMPORTED_MODULE_2__utils_authUtils__[\"a\" /* default */].setTwiceToken(ret.data.adminTwoStepAuthToken);\n            this.$router.replace({ name: 'main' });\n        } else if (ret) {\n            xmview.showTip('error', ret.message);\n            this.$router.replace({ name: 'login-twice' });\n        }\n        this.user = __WEBPACK_IMPORTED_MODULE_2__utils_authUtils__[\"a\" /* default */].getUserInfo();\n        this.loadingdata = true;\n    },\n    mounted: function mounted() {\n        var _this = this;\n\n        // 获取已绑定的信息\n        __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__[\"a\" /* default */].getSafeSetInfo().then(function (ret) {\n            // 如果都没绑定  跳到绑定页面\n            if (!ret || !ret.sms && !ret.email && !ret.wechat) {\n                _this.$router.replace({ name: 'mine-safeset' });\n            } else {\n                _this.sms = ret.sms;\n                _this.email = ret.email;\n                _this.wechat = ret.wechat;\n                _this.wechatConfig = ret.wechatConfig;\n            }\n\n            _this.loadingdata = false;\n\n            // 设置当前选中的tab\n            if (_this.wechat) _this.tabSelected = 'wechat';else if (_this.sms) _this.tabSelected = 'sms';else _this.tabSelected = 'email';\n        }).then(function () {\n            // 如果绑定了微信 初始化微信登录二维码\n            if (!_this.wechatConfig) return;\n\n            _this.wechatConfig.redirect_uri = _this.wechatConfig.redirect_uri + '&redirect_url=' + window.location.href;\n            // 初始化微信扫码二维码\n            _this.wechatConfig.id = 'login-twice-wechatlogin';\n\n            _this.$nextTick(function () {\n                __WEBPACK_IMPORTED_MODULE_0__vendor_wechatSdk__[\"a\" /* default */].initLogin(_this.wechatConfig);\n            });\n        }).catch(function (err) {\n            _this.loadingdata = false;\n            console.info('出错', err);\n        });\n    },\n    beforeDestroy: function beforeDestroy() {\n        xmview.closeAllTip();\n    },\n\n    methods: {\n        // type 0- 手机 1-邮箱\n        sendValidCode: function sendValidCode(type) {\n            var _this2 = this;\n\n            this.codeWaitSecond = -1;\n            var p = void 0;\n            if (type == 0) {\n                p = __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__[\"a\" /* default */].sendSmsValidcode();\n            } else if (type == 1) {\n                p = __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__[\"a\" /* default */].sendEmailValidcode();\n            }\n            p.then(function () {\n                xmview.showTip('success', '验证码发送成功,请注意查收');\n                _this2.codeWaitSecond = 60;\n                var intervalId = setInterval(function () {\n                    _this2.codeWaitSecond--;\n                    if (_this2.codeWaitSecond <= 0) clearInterval(intervalId);\n                }, 1000);\n            }).catch(function () {\n                _this2.codeWaitSecond = 0;\n            });\n        },\n\n        // type 0- 手机 1-邮箱\n        login: function login(type) {\n            var _this3 = this;\n\n            this.logining = true;\n            var code = type == 0 ? this.smsCode : this.emailCode;\n            var p = type == 0 ? __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__[\"a\" /* default */].twiceSmsValid({ code: code }) : __WEBPACK_IMPORTED_MODULE_1__services_base_twoStepService__[\"a\" /* default */].twiceEmailValid({ code: code });\n            p.then(function (ret) {\n                __WEBPACK_IMPORTED_MODULE_2__utils_authUtils__[\"a\" /* default */].setTwiceToken(ret);\n                var item = __WEBPACK_IMPORTED_MODULE_2__utils_authUtils__[\"a\" /* default */].getNavMenu()[0];\n                while (item.children && item.children.length > 0) {\n                    item = item.children[0];\n                }_this3.$router.push({ path: item.item.menu_url });\n\n                xmview.showTip('success', '验证成功, 跳转中...', 1e9);\n            }).catch(function () {\n                setTimeout(function () {\n                    _this3.logining = false;\n                }, 300);\n            });\n        }\n    },\n    components: {}\n});\n\n/***/ }),\n\n/***/ 808:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__api__ = __webpack_require__(24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__utils_config__ = __webpack_require__(4);\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n\n\n\nvar urlPre = __WEBPACK_IMPORTED_MODULE_1__utils_config__[\"a\" /* default */].apiHost + '/two-step';\n\nvar TwoStepService = function () {\n    function TwoStepService() {\n        _classCallCheck(this, TwoStepService);\n    }\n\n    _createClass(TwoStepService, [{\n        key: 'getSafeSetInfo',\n\n        // 获取校验信息\n        value: function getSafeSetInfo() {\n            var url = urlPre + '/';\n            return __WEBPACK_IMPORTED_MODULE_0__api__[\"b\" /* get */](url).then(function (ret) {\n                return ret.data;\n            });\n        }\n\n        // 发送邮箱验证码\n\n    }, {\n        key: 'sendEmailValidcode',\n        value: function sendEmailValidcode() {\n            var url = urlPre + '/email/send';\n            return __WEBPACK_IMPORTED_MODULE_0__api__[\"a\" /* post */](url);\n        }\n\n        // 发送短信验证码\n\n    }, {\n        key: 'sendSmsValidcode',\n        value: function sendSmsValidcode() {\n            var url = urlPre + '/sms/send';\n            return __WEBPACK_IMPORTED_MODULE_0__api__[\"a\" /* post */](url);\n        }\n\n        // 短信二次验证\n\n    }, {\n        key: 'twiceSmsValid',\n        value: function twiceSmsValid(_ref) {\n            var code = _ref.code;\n\n            var url = urlPre + '/sms/verify';\n            return __WEBPACK_IMPORTED_MODULE_0__api__[\"a\" /* post */](url, { code: code }).then(function (ret) {\n                return ret.data.userTwoStepAuthToken;\n            });\n        }\n\n        // 邮箱二次验证\n\n    }, {\n        key: 'twiceEmailValid',\n        value: function twiceEmailValid(_ref2) {\n            var code = _ref2.code;\n\n            var url = urlPre + '/email/verify';\n            return __WEBPACK_IMPORTED_MODULE_0__api__[\"a\" /* post */](url, { code: code }).then(function (ret) {\n                return ret.data.userTwoStepAuthToken;\n            });\n        }\n    }]);\n\n    return TwoStepService;\n}();\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new TwoStepService());\n\n/***/ }),\n\n/***/ 823:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(150)(true);\n// imports\n\n\n// module\nexports.push([module.i, \"#login-twice{position:absolute;min-height:100%;width:100%;background:#d9e0e7}#login-twice>*{width:500px;margin:0 auto}#login-twice .tip{color:#666;margin-bottom:15px;display:block}#login-twice h5{margin-top:35px;text-align:right}#login-twice .el-card__header{padding:10px;background:#f8f8f8}#login-twice .el-input{width:50%;display:inline-block;vertical-align:top}#login-twice .center-slit{margin:9px 0}#login-twice #login-twice-wechatlogin{text-align:center}\", \"\", {\"version\":3,\"sources\":[\"/home/zhaoyicheng/devspace/sys_ui/assets/src/views/base/login/TwiceValid.vue\"],\"names\":[],\"mappings\":\"AACA,aAAa,kBAAkB,gBAAgB,WAAW,kBAAkB,CAC3E,AACD,eAAe,YAAY,aAAa,CACvC,AACD,kBAAkB,WAAW,mBAAmB,aAAa,CAC5D,AACD,gBAAgB,gBAAgB,gBAAgB,CAC/C,AACD,8BAA8B,aAAa,kBAAkB,CAC5D,AACD,uBAAuB,UAAU,qBAAqB,kBAAkB,CACvE,AACD,0BAA0B,YAAY,CACrC,AACD,sCAAsC,iBAAiB,CACtD\",\"file\":\"TwiceValid.vue\",\"sourcesContent\":[\"\\n#login-twice{position:absolute;min-height:100%;width:100%;background:#d9e0e7\\n}\\n#login-twice>*{width:500px;margin:0 auto\\n}\\n#login-twice .tip{color:#666;margin-bottom:15px;display:block\\n}\\n#login-twice h5{margin-top:35px;text-align:right\\n}\\n#login-twice .el-card__header{padding:10px;background:#f8f8f8\\n}\\n#login-twice .el-input{width:50%;display:inline-block;vertical-align:top\\n}\\n#login-twice .center-slit{margin:9px 0\\n}\\n#login-twice #login-twice-wechatlogin{text-align:center\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ 878:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(823);\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(151)(\"1e1a3016\", content, true);\n\n/***/ }),\n\n/***/ 951:\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('article', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loadingdata),\n      expression: \"loadingdata\"\n    }],\n    attrs: {\n      \"id\": \"login-twice\"\n    }\n  }, [_c('h5', [_c('i', [_vm._v(_vm._s(_vm.user.name) + \"，\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"text\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.$router.replace({\n          name: 'login'\n        })\n      }\n    }\n  }, [_vm._v(\"切换账号\")])], 1), _vm._v(\" \"), _c('el-card', {\n    staticClass: \"box-card\"\n  }, [_c('div', {\n    staticClass: \"head\",\n    slot: \"header\"\n  }, [_c('i', [_vm._v(\"二次验证\")])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"container\"\n  }, [_c('i', {\n    staticClass: \"tip\"\n  }, [_c('i', {\n    staticClass: \"el-icon-warning\"\n  }), _vm._v(\" 为进一步确保您的账号信息和其他内容的安全，请选择任一种方式进行账号校验\")]), _vm._v(\" \"), _c('el-tabs', {\n    attrs: {\n      \"type\": \"card\",\n      \"value\": _vm.tabSelected\n    }\n  }, [(_vm.wechat) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"微信扫码登录\",\n      \"name\": \"wechat\"\n    }\n  }, [_c('div', [_vm._v(\"您设置的验证微信账号是：\" + _vm._s(_vm.wechat.data) + \", 请扫码登录\")]), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"login-twice-wechatlogin\"\n    }\n  })]) : _vm._e(), _vm._v(\" \"), (_vm.sms) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"手机号码验证\",\n      \"name\": \"sms\"\n    }\n  }, [_c('i', [_vm._v(\"您设置的手机号码是 (\" + _vm._s(_vm.sms.data) + \")\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"center-slit\"\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"填写手机验证码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.login(0)\n      }\n    },\n    model: {\n      value: (_vm.smsCode),\n      callback: function($$v) {\n        _vm.smsCode = $$v\n      },\n      expression: \"smsCode\"\n    }\n  }), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"disabled\": _vm.codeWaitSecond !== 0\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.sendValidCode(0)\n      }\n    }\n  }, [(_vm.codeWaitSecond <= 0) ? _c('i', [_vm._v(\"发送验证码\")]) : _c('i', [_vm._v(_vm._s(_vm.codeWaitSecond) + \" 秒后重发\")])])], 1), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.login(0)\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.email) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"邮箱验证\",\n      \"name\": \"email\"\n    }\n  }, [_c('i', [_vm._v(\"您设置的邮箱码是 (\" + _vm._s(_vm.email.data) + \")\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"center-slit\"\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"填写邮箱验证码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.login(1)\n      }\n    },\n    model: {\n      value: (_vm.emailCode),\n      callback: function($$v) {\n        _vm.emailCode = $$v\n      },\n      expression: \"emailCode\"\n    }\n  }), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"disabled\": _vm.codeWaitSecond !== 0\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.sendValidCode(1)\n      }\n    }\n  }, [(_vm.codeWaitSecond <= 0) ? _c('i', [_vm._v(\"发送验证码\")]) : _c('i', [_vm._v(_vm._s(_vm.codeWaitSecond) + \" 秒后重发\")])])], 1), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\",\n      \"disabled\": _vm.logining\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.login(1)\n      }\n    }\n  }, [(!_vm.logining) ? _c('i', [_vm._v(\"登录\")]) : _c('i', [_vm._v(\"登录中...\")])])], 1) : _vm._e()], 1)], 1)])], 1)\n},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/45.8463b59f366c3431e557.js","\n/* styles */\nrequire(\"!!../../../../node_modules/_extract-text-webpack-plugin@2.1.2@extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/style-rewriter?{\\\"id\\\":\\\"data-v-3d7e5bae\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/selector?type=styles&index=0!./TwiceValid.vue\")\n\nvar Component = require(\"!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/selector?type=script&index=0!./TwiceValid.vue\"),\n  /* template */\n  require(\"!!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/template-compiler?{\\\"id\\\":\\\"data-v-3d7e5bae\\\"}!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/selector?type=template&index=0!./TwiceValid.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/base/login/TwiceValid.vue\n// module id = 157\n// module chunks = 45","/**\n * Created by huanghuixin on 2017/4/13.\n */\n\nimport config from '../utils/config'\nlet currMsgListener = void 0\nlet wechatSdk = {\n    // 初始化二维码\n    initLogin (wechatConfig) {\n        return new Promise((resolve, reject) => {\n            if (window.WxLogin) {\n                resolve(true)\n                return\n            }\n\n            let script = document.createElement('script')\n            script.src = '//res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js'\n            document.head.appendChild(script)\n            script.onload = function () {\n                resolve(true)\n            }\n        }).then(() => {\n            // mine/two-step/wechat/callback?verify=\n            wechatConfig = Object.assign({}, wechatConfig, {\n                style: 'white',\n                href: ''\n            })\n\n            wechatConfig.redirect_uri = encodeURIComponent(wechatConfig.redirect_uri)\n            return new window.WxLogin(wechatConfig)\n        }).catch(err => {\n            console.info('微信二维码初始化失败', err)\n        })\n    },\n\n    buildUrl ({appid, scope, redirect_uri, state}) {\n        // config.debug && (redirect_uri = 'http://sys.yst.vodjk.com/mine/two-step/wechat/callback?verify=1')\n        return `https://open.weixin.qq.com/connect/qrconnect?state=${state}&appid=${appid}&scope=${scope}&redirect_uri=${encodeURIComponent(redirect_uri)}&login_type=jssdk&style=white`\n    },\n\n    openWechatLogin ({appid, scope, redirect_uri, state, verify}, callback) {\n        // 先移除事件\n        currMsgListener && window.removeEventListener('message', currMsgListener)\n\n        if (verify)\n            redirect_uri = redirect_uri.replace('verify=', 'verify=' + verify)\n\n        // 打开登录tab\n        let tab = window.open(wechatSdk.buildUrl({appid, scope, redirect_uri, state}))\n        // 回调事件\n        currMsgListener = (e) => {\n            callback(e.data)\n            tab.close()\n            window.removeEventListener('message', currMsgListener)\n            tab = null\n            currMsgListener = null\n        }\n        window.addEventListener('message', currMsgListener, false)\n    }\n}\n\nexport default wechatSdk\n\n\n// WEBPACK FOOTER //\n// ./src/vendor/wechatSdk.js","<!--二次验证-->\n<style lang='scss' rel='stylesheet/scss'>\n    #login-twice {\n        position: absolute;\n        min-height: 100%;\n        width: 100%;\n        background: #d9e0e7;\n\n        > * {\n            width: 500px;\n            margin: 0 auto;\n        }\n\n        .tip {\n            color: #666;\n            margin-bottom: 15px;\n            display: block;\n        }\n        h5 {\n            margin-top: 35px;\n            text-align: right;\n        }\n\n        .el-card__header {\n            padding: 10px;\n            background: #f8f8f8;\n        }\n\n        .el-input {\n            width: 50%;\n            display: inline-block;\n            vertical-align: top;\n        }\n\n        .center-slit {\n            margin: 9px 0;\n        }\n\n        #login-twice-wechatlogin {\n            text-align: center;\n        }\n    }\n</style>\n\n<template>\n    <article id=\"login-twice\" v-loading=\"loadingdata\">\n        <h5>\n            <i>{{user.name}}，</i>\n            <el-button type=\"text\" @click=\"$router.replace({name:'login'})\">切换账号</el-button>\n        </h5>\n\n        <el-card class=\"box-card\">\n            <div slot=\"header\" class=\"head\">\n                <i>二次验证</i>\n            </div>\n            <div class=\"container\">\n                <i class=\"tip\"> <i class=\"el-icon-warning\"></i> 为进一步确保您的账号信息和其他内容的安全，请选择任一种方式进行账号校验</i>\n                <el-tabs type=\"card\" :value=\"tabSelected\">\n                    <el-tab-pane label=\"微信扫码登录\" name=\"wechat\" v-if=\"wechat\">\n                        <div>您设置的验证微信账号是：{{wechat.data}}, 请扫码登录</div>\n                        <div id=\"login-twice-wechatlogin\"></div>\n                    </el-tab-pane>\n                    <el-tab-pane label=\"手机号码验证\" name=\"sms\" v-if=\"sms\">\n                        <i>您设置的手机号码是 ({{sms.data}})</i>\n                        <div class=\"center-slit\">\n                            <el-input v-model=\"smsCode\" placeholder=\"填写手机验证码\" @keyup.enter.native=\"login(0)\"></el-input>\n                            <el-button :disabled=\"codeWaitSecond !== 0\" @click=\"sendValidCode(0)\">\n                                <i v-if=\"codeWaitSecond <= 0\">发送验证码</i>\n                                <i v-else>{{codeWaitSecond}} 秒后重发</i>\n                            </el-button>\n                        </div>\n                        <el-button type=\"primary\" @click=\"login(0)\">登录</el-button>\n                    </el-tab-pane>\n                    <el-tab-pane label=\"邮箱验证\" name=\"email\" v-if=\"email\">\n                        <i>您设置的邮箱码是 ({{email.data}})</i>\n                        <div class=\"center-slit\">\n                            <el-input v-model=\"emailCode\" placeholder=\"填写邮箱验证码\"\n                                      @keyup.enter.native=\"login(1)\"></el-input>\n                            <el-button :disabled=\"codeWaitSecond !== 0\" @click=\"sendValidCode(1)\">\n                                <i v-if=\"codeWaitSecond <= 0\">发送验证码</i>\n                                <i v-else>{{codeWaitSecond}} 秒后重发</i>\n                            </el-button>\n                        </div>\n                        <el-button type=\"primary\" @click=\"login(1)\" :disabled=\"logining\">\n                            <i v-if=\"!logining\">登录</i>\n                            <i v-else>登录中...</i>\n                        </el-button>\n                    </el-tab-pane>\n                </el-tabs>\n            </div>\n        </el-card>\n    </article>\n</template>\n\n<script>\n    import wechatSdk from '../../../vendor/wechatSdk'\n    import twiceService from '../../../services/base/twoStepService'\n    import authUtils from '../../../utils/authUtils'\n\n    export default {\n        data () {\n            return {\n                loadingdata: false,\n                wechat: void 0,\n                email: void 0,\n                sms: void 0,\n                wechatConfig: void 0,\n                user: {},\n                codeWaitSecond: 0, // 验证码发送后的等待时间 -1表示不可用 比如正在请求发送验证码接口\n                smsCode: void 0,\n                emailCode: void 0,\n                tabSelected: 'first', // 选中的tab\n                logining: false, // 正在登录请求的状态\n            }\n        },\n        created () {\n            let ret = this.$route.query.callback ? JSON.parse(this.$route.query.callback) : void 0\n\n            if (ret && ret.code == 0) {\n                authUtils.setTwiceToken(ret.data.adminTwoStepAuthToken)\n                this.$router.replace({name: 'main'})\n            } else if (ret) {\n                xmview.showTip('error', ret.message)\n                this.$router.replace({name: 'login-twice'})\n            }\n            this.user = authUtils.getUserInfo()\n            this.loadingdata = true\n        },\n        mounted () {\n            // 获取已绑定的信息\n            twiceService.getSafeSetInfo().then((ret) => {\n                // 如果都没绑定  跳到绑定页面\n                if (!ret || (!ret.sms && !ret.email && !ret.wechat)) {\n                    this.$router.replace({name: 'mine-safeset'})\n                } else {\n                    this.sms = ret.sms\n                    this.email = ret.email\n                    this.wechat = ret.wechat\n                    this.wechatConfig = ret.wechatConfig\n                }\n\n                this.loadingdata = false\n\n                // 设置当前选中的tab\n                if (this.wechat) this.tabSelected = 'wechat'\n                else if (this.sms) this.tabSelected = 'sms'\n                else this.tabSelected = 'email'\n            }).then(() => {\n                // 如果绑定了微信 初始化微信登录二维码\n                if (!this.wechatConfig) return\n\n                this.wechatConfig.redirect_uri = `${this.wechatConfig.redirect_uri}&redirect_url=${window.location.href}`\n                // 初始化微信扫码二维码\n                this.wechatConfig.id = 'login-twice-wechatlogin'\n\n                this.$nextTick(() => {\n                    wechatSdk.initLogin(this.wechatConfig)\n                })\n            }).catch((err) => {\n                this.loadingdata = false\n                console.info('出错', err)\n            })\n        },\n        beforeDestroy () {\n            xmview.closeAllTip()\n        },\n        methods: {\n            // type 0- 手机 1-邮箱\n            sendValidCode (type) {\n                this.codeWaitSecond = -1\n                let p\n                if (type == 0) {\n                    p = twiceService.sendSmsValidcode()\n                } else if (type == 1) {\n                    p = twiceService.sendEmailValidcode()\n                }\n                p.then(() => {\n                    xmview.showTip('success', '验证码发送成功,请注意查收')\n                    this.codeWaitSecond = 60\n                    let intervalId = setInterval(() => {\n                        this.codeWaitSecond--\n                        if (this.codeWaitSecond <= 0) clearInterval(intervalId)\n                    }, 1000)\n                }).catch(() => {\n                    this.codeWaitSecond = 0\n                })\n            },\n            // type 0- 手机 1-邮箱\n            login (type) {\n                this.logining = true\n                let code = type == 0 ? this.smsCode : this.emailCode\n                let p = type == 0 ? twiceService.twiceSmsValid({code}) : twiceService.twiceEmailValid({code})\n                p.then((ret) => {\n                    authUtils.setTwiceToken(ret)\n                    let item = authUtils.getNavMenu()[0]\n                    while (item.children && item.children.length > 0)\n                        item = item.children[0]\n                    this.$router.push({path: item.item.menu_url})\n\n                    xmview.showTip('success', '验证成功, 跳转中...', 1e9)\n                }).catch(() => {\n                    setTimeout(() => {\n                        this.logining = false\n                    }, 300)\n                })\n            }\n        },\n        components: {}\n    }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// TwiceValid.vue?1b120a74","import * as api from '../api'\nimport config from '../../utils/config'\n\nconst urlPre = config.apiHost + '/two-step'\n\nclass TwoStepService {\n    // 获取校验信息\n    getSafeSetInfo () {\n        let url = `${urlPre}/`\n        return api.get(url).then(ret => {\n            return ret.data\n        })\n    }\n\n    // 发送邮箱验证码\n    sendEmailValidcode () {\n        let url = `${urlPre}/email/send`\n        return api.post(url)\n    }\n\n    // 发送短信验证码\n    sendSmsValidcode () {\n        let url = `${urlPre}/sms/send`\n        return api.post(url)\n    }\n\n    // 短信二次验证\n    twiceSmsValid ({code}) {\n        let url = `${urlPre}/sms/verify`\n        return api.post(url, {code}).then((ret) => {\n            return ret.data.userTwoStepAuthToken\n        })\n    }\n\n    // 邮箱二次验证\n    twiceEmailValid ({code}) {\n        let url = `${urlPre}/email/verify`\n        return api.post(url, {code}).then((ret) => {\n            return ret.data.userTwoStepAuthToken\n        })\n    }\n}\n\nexport default new TwoStepService()\n\n\n\n// WEBPACK FOOTER //\n// ./src/services/base/twoStepService.js","exports = module.exports = require(\"../../../../node_modules/_css-loader@0.27.3@css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"#login-twice{position:absolute;min-height:100%;width:100%;background:#d9e0e7}#login-twice>*{width:500px;margin:0 auto}#login-twice .tip{color:#666;margin-bottom:15px;display:block}#login-twice h5{margin-top:35px;text-align:right}#login-twice .el-card__header{padding:10px;background:#f8f8f8}#login-twice .el-input{width:50%;display:inline-block;vertical-align:top}#login-twice .center-slit{margin:9px 0}#login-twice #login-twice-wechatlogin{text-align:center}\", \"\", {\"version\":3,\"sources\":[\"/home/zhaoyicheng/devspace/sys_ui/assets/src/views/base/login/TwiceValid.vue\"],\"names\":[],\"mappings\":\"AACA,aAAa,kBAAkB,gBAAgB,WAAW,kBAAkB,CAC3E,AACD,eAAe,YAAY,aAAa,CACvC,AACD,kBAAkB,WAAW,mBAAmB,aAAa,CAC5D,AACD,gBAAgB,gBAAgB,gBAAgB,CAC/C,AACD,8BAA8B,aAAa,kBAAkB,CAC5D,AACD,uBAAuB,UAAU,qBAAqB,kBAAkB,CACvE,AACD,0BAA0B,YAAY,CACrC,AACD,sCAAsC,iBAAiB,CACtD\",\"file\":\"TwiceValid.vue\",\"sourcesContent\":[\"\\n#login-twice{position:absolute;min-height:100%;width:100%;background:#d9e0e7\\n}\\n#login-twice>*{width:500px;margin:0 auto\\n}\\n#login-twice .tip{color:#666;margin-bottom:15px;display:block\\n}\\n#login-twice h5{margin-top:35px;text-align:right\\n}\\n#login-twice .el-card__header{padding:10px;background:#f8f8f8\\n}\\n#login-twice .el-input{width:50%;display:inline-block;vertical-align:top\\n}\\n#login-twice .center-slit{margin:9px 0\\n}\\n#login-twice #login-twice-wechatlogin{text-align:center\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_css-loader@0.27.3@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@11.1.4@vue-loader/lib/style-rewriter.js?{\"id\":\"data-v-3d7e5bae\",\"scoped\":false,\"hasInlineConfig\":false}!./~/_sass-loader@4.1.1@sass-loader?{\"sourceMap\":true}!./~/_vue-loader@11.1.4@vue-loader/lib/selector.js?type=styles&index=0!./src/views/base/login/TwiceValid.vue\n// module id = 823\n// module chunks = 45","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/_css-loader@0.27.3@css-loader/index.js?{\\\"minimize\\\":true,\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/style-rewriter.js?{\\\"id\\\":\\\"data-v-3d7e5bae\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../node_modules/_sass-loader@4.1.1@sass-loader/index.js?{\\\"sourceMap\\\":true}!../../../../node_modules/_vue-loader@11.1.4@vue-loader/lib/selector.js?type=styles&index=0!./TwiceValid.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../../node_modules/_vue-style-loader@2.0.5@vue-style-loader/lib/addStylesClient.js\")(\"1e1a3016\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_extract-text-webpack-plugin@2.1.2@extract-text-webpack-plugin/loader.js?{\"omit\":1,\"remove\":true}!./~/_vue-style-loader@2.0.5@vue-style-loader!./~/_css-loader@0.27.3@css-loader?{\"minimize\":true,\"sourceMap\":true}!./~/_vue-loader@11.1.4@vue-loader/lib/style-rewriter.js?{\"id\":\"data-v-3d7e5bae\",\"scoped\":false,\"hasInlineConfig\":false}!./~/_sass-loader@4.1.1@sass-loader?{\"sourceMap\":true}!./~/_vue-loader@11.1.4@vue-loader/lib/selector.js?type=styles&index=0!./src/views/base/login/TwiceValid.vue\n// module id = 878\n// module chunks = 45","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('article', {\n    directives: [{\n      name: \"loading\",\n      rawName: \"v-loading\",\n      value: (_vm.loadingdata),\n      expression: \"loadingdata\"\n    }],\n    attrs: {\n      \"id\": \"login-twice\"\n    }\n  }, [_c('h5', [_c('i', [_vm._v(_vm._s(_vm.user.name) + \"，\")]), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"text\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.$router.replace({\n          name: 'login'\n        })\n      }\n    }\n  }, [_vm._v(\"切换账号\")])], 1), _vm._v(\" \"), _c('el-card', {\n    staticClass: \"box-card\"\n  }, [_c('div', {\n    staticClass: \"head\",\n    slot: \"header\"\n  }, [_c('i', [_vm._v(\"二次验证\")])]), _vm._v(\" \"), _c('div', {\n    staticClass: \"container\"\n  }, [_c('i', {\n    staticClass: \"tip\"\n  }, [_c('i', {\n    staticClass: \"el-icon-warning\"\n  }), _vm._v(\" 为进一步确保您的账号信息和其他内容的安全，请选择任一种方式进行账号校验\")]), _vm._v(\" \"), _c('el-tabs', {\n    attrs: {\n      \"type\": \"card\",\n      \"value\": _vm.tabSelected\n    }\n  }, [(_vm.wechat) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"微信扫码登录\",\n      \"name\": \"wechat\"\n    }\n  }, [_c('div', [_vm._v(\"您设置的验证微信账号是：\" + _vm._s(_vm.wechat.data) + \", 请扫码登录\")]), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"login-twice-wechatlogin\"\n    }\n  })]) : _vm._e(), _vm._v(\" \"), (_vm.sms) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"手机号码验证\",\n      \"name\": \"sms\"\n    }\n  }, [_c('i', [_vm._v(\"您设置的手机号码是 (\" + _vm._s(_vm.sms.data) + \")\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"center-slit\"\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"填写手机验证码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.login(0)\n      }\n    },\n    model: {\n      value: (_vm.smsCode),\n      callback: function($$v) {\n        _vm.smsCode = $$v\n      },\n      expression: \"smsCode\"\n    }\n  }), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"disabled\": _vm.codeWaitSecond !== 0\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.sendValidCode(0)\n      }\n    }\n  }, [(_vm.codeWaitSecond <= 0) ? _c('i', [_vm._v(\"发送验证码\")]) : _c('i', [_vm._v(_vm._s(_vm.codeWaitSecond) + \" 秒后重发\")])])], 1), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\"\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.login(0)\n      }\n    }\n  }, [_vm._v(\"登录\")])], 1) : _vm._e(), _vm._v(\" \"), (_vm.email) ? _c('el-tab-pane', {\n    attrs: {\n      \"label\": \"邮箱验证\",\n      \"name\": \"email\"\n    }\n  }, [_c('i', [_vm._v(\"您设置的邮箱码是 (\" + _vm._s(_vm.email.data) + \")\")]), _vm._v(\" \"), _c('div', {\n    staticClass: \"center-slit\"\n  }, [_c('el-input', {\n    attrs: {\n      \"placeholder\": \"填写邮箱验证码\"\n    },\n    nativeOn: {\n      \"keyup\": function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"enter\", 13)) { return null; }\n        _vm.login(1)\n      }\n    },\n    model: {\n      value: (_vm.emailCode),\n      callback: function($$v) {\n        _vm.emailCode = $$v\n      },\n      expression: \"emailCode\"\n    }\n  }), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"disabled\": _vm.codeWaitSecond !== 0\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.sendValidCode(1)\n      }\n    }\n  }, [(_vm.codeWaitSecond <= 0) ? _c('i', [_vm._v(\"发送验证码\")]) : _c('i', [_vm._v(_vm._s(_vm.codeWaitSecond) + \" 秒后重发\")])])], 1), _vm._v(\" \"), _c('el-button', {\n    attrs: {\n      \"type\": \"primary\",\n      \"disabled\": _vm.logining\n    },\n    on: {\n      \"click\": function($event) {\n        _vm.login(1)\n      }\n    }\n  }, [(!_vm.logining) ? _c('i', [_vm._v(\"登录\")]) : _c('i', [_vm._v(\"登录中...\")])])], 1) : _vm._e()], 1)], 1)])], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_vue-loader@11.1.4@vue-loader/lib/template-compiler.js?{\"id\":\"data-v-3d7e5bae\"}!./~/_vue-loader@11.1.4@vue-loader/lib/selector.js?type=template&index=0!./src/views/base/login/TwiceValid.vue\n// module id = 951\n// module chunks = 45"],"sourceRoot":""}