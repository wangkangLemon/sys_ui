webpackJsonp([41],{149:function(e,t,n){n(398);var a=n(10)(n(276),n(461),null,null);e.exports=a.exports},210:function(e,t,n){"use strict";(function(e){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=n(23),o=n(3),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=o.a.apiHost+"/mine",s=function(){function t(){a(this,t)}return r(t,[{key:"updateProfile",value:function(e){var t=e.name,n=e.address,a=e.sex,o=c+"/profile";return i.c(o,{name:t,address:n,sex:a})}},{key:"uploadAvatar",value:function(t){var n=t.avatar,a=t.alias,o=c+"/profile/avatar";return i.a(o,{avatar:n,alias:a}).then(function(t){return t.code?e.reject(t):t})}},{key:"getCompanyInfo",value:function(){var e=c+"/company";return i.b(e).then(function(e){return e.data.data})}},{key:"modifyCompany",value:function(t){var n=t.name,a=t.concact,o=t.mobile,r=t.email,s=t.tel,l=t.fax,d=t.province,u=t.city,f=t.area,h=t.address,v=t.zip,p=t.url,m=t.description,g=c+"/company";return i.c(g,{name:n,concact:a,mobile:o,email:r,tel:s,fax:l,province:d,city:u,area:f,address:h,zip:v,url:p,description:m}).then(function(t){if(t.code)return e.reject(t)})}},{key:"modifyPassword",value:function(t){var n=t.origin_password,a=t.new_password,o=t.re_password,r=c+"/password";return i.c(r,{origin_password:n,new_password:a,re_password:o}).then(function(t){if(t.code)return e.reject(t)})}},{key:"getSafeSetInfo",value:function(){var e=c+"/two-step/";return i.b(e).then(function(e){return e.data})}},{key:"getWechatLoginConfig",value:function(){var e=c+"/two-step/wechat";return i.b(e).then(function(e){return e.data.wechatConfig})}},{key:"bindOrChangeTwo",value:function(e){var t=e.type,n=e.code,a=e.receiver,o=c+"/two-step/code/bind";return i.c(o,{type:t,code:n,receiver:a}).then(function(e){return e.data.userTwoStepAuthToken})}},{key:"sendTwoValidCode",value:function(e){var t=e.type,n=e.receiver,a=c+"/two-step/code/send";return i.a(a,{type:t,receiver:n})}},{key:"validTwoVliadCode",value:function(e){var t=e.code,n=e.type,a=c+"/two-step/code/verify";return i.a(a,{code:t,type:n}).then(function(e){return e.data.userTwoStepAuthToken})}}]),t}();t.a=new s}).call(t,n(9))},252:function(e,t,n){"use strict";(function(e){var a=(n(3),void 0),i={initLogin:function(t){return new e(function(e,t){if(window.WxLogin)return void e(!0);var n=document.createElement("script");n.src="//res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js",document.head.appendChild(n),n.onload=function(){e(!0)}}).then(function(){return t=Object.assign({},t,{style:"white",href:""}),t.redirect_uri=encodeURIComponent(t.redirect_uri),new window.WxLogin(t)}).catch(function(e){})},buildUrl:function(e){var t=e.appid,n=e.scope,a=e.redirect_uri;return"https://open.weixin.qq.com/connect/qrconnect?state="+e.state+"&appid="+t+"&scope="+n+"&redirect_uri="+encodeURIComponent(a)+"&login_type=jssdk&style=white"},openWechatLogin:function(e,t){var n=e.appid,o=e.scope,r=e.redirect_uri,c=e.state,s=e.verify;a&&window.removeEventListener("message",a),s&&(r=r.replace("verify=","verify="+s));var l=window.open(i.buildUrl({appid:n,scope:o,redirect_uri:r,state:c}));a=function(e){t(e.data),l.close(),window.removeEventListener("message",a),l=null,a=null},window.addEventListener("message",a,!1)}};t.a=i}).call(t,n(9))},276:function(e,t,n){"use strict";function a(){return{type:"email",code:"",receiver:""}}function i(e){if(!e)return e;var t=e.split("@")[0];return t[0]+"***"+t[t.length-1]+"@"+e.split("@")[1]}function o(e){if(e)return e.slice(0,3)+"****"+e.slice(-4,e.length)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(210),c=n(252),s=n(4);t.default={data:function(){return{email:{},sms:{},wechat:{},wechatConfig:void 0,fetchParam:a(),dialogBind:{isShow:!1,validWait:0},dialogChange:{isShow:!1}}},created:function(){this.initData(),s.a.clearAuthRefreshToken()},destroyed:function(){s.a.authRefreshtoken()},methods:{changeEmail:function(){this.fetchParam.type="email",this.fetchParam.code="",this.fetchParam.receiver=this.email.data,this.dialogChange.isShow=!0},changeSms:function(){this.fetchParam.type="sms",this.fetchParam.code="",this.fetchParam.receiver=this.sms.data,this.dialogChange.isShow=!0},bindEmail:function(){this.fetchParam=a(),this.fetchParam.type="email",this.dialogBind.isShow=!0},bindSms:function(){this.fetchParam=a(),this.fetchParam.type="sms",this.dialogBind.isShow=!0},bindWechat:function(){var e=this;c.a.openWechatLogin(this.wechatConfig,function(t){t=JSON.parse(t),0==t.code?(s.a.setTwiceToken(t.data.adminTwoStepAuthToken),e.initData(),e.$store.dispatch("setIndexNavMenu",{menu:s.a.getNavMenu()}),xmview.showTip("success","操作成功",5e3)):xmview.showTip("error",t.message)})},changeWechat:function(){var e=this,t=Object.assign({},this.wechatConfig,{verify:"xm"});c.a.openWechatLogin(t,function(t){t=JSON.parse(t),0==t.code?r.a.getSafeSetInfo().then(function(t){t.message?xmview.showTip("error",t.message,5e3):(e.wechat={},xmview.showTip("success","操作成功!请重新绑定新的微信",5e3))}).then(function(){r.a.getWechatLoginConfig().then(function(t){e.wechatConfig=t})}):xmview.showTip("error",t.message,5e3)})},sendBindValidCode:function(){var e=this,t={type:this.fetchParam.type,receiver:this.fetchParam.receiver.indexOf("***")>-1?"":this.fetchParam.receiver};r.a.sendTwoValidCode(t).then(function(){xmview.showTip("success","验证码发送成功,请注意查收"),e.dialogBind.validWait=60;var t=setInterval(function(){--e.dialogBind.validWait<=0&&clearInterval(t)},1e3)})},bindFn:function(){var e=this;r.a.bindOrChangeTwo(this.fetchParam).then(function(t){s.a.setTwiceToken(t),e[e.fetchParam.type]={data:e.fetchParam.receiver},e.dialogBind.isShow=!1,e.dialogChange.isShow=!1,e.$store.dispatch("setIndexNavMenu",{menu:s.a.getNavMenu()}),xmview.showTip("success","操作成功")}).catch(function(e){})},validCode:function(){var e=this;r.a.validTwoVliadCode(this.fetchParam).then(function(t){e.dialogBind.validWait=0,e.dialogChange.isShow=!1,setTimeout(function(){e.dialogBind.isShow=!0},500),e.fetchParam.code="",e.fetchParam.receiver="",s.a.setTwiceToken(t)})},initData:function(){var e=this;r.a.getSafeSetInfo().then(function(t){t&&t.stepTypes?t.stepTypes.forEach(function(t){"sms"===t.type?(e.sms=t,e.sms&&(e.sms.data=o(e.sms.data))):"email"===t.type?(e.email=t,e.email&&(e.email.data=i(e.email.data))):e.wechat=t}):(e.$store.dispatch("setIndexNavMenu",{menu:[]}),xmview.setContentBack(!1)),xmview.setContentLoading(!1)}).catch(function(e){}).then(function(){r.a.getWechatLoginConfig().then(function(t){e.wechatConfig=t})})}},components:{}}},346:function(e,t,n){t=e.exports=n(138)(!0),t.push([e.i,"#user-sefeset-container .el-card__header{background:#f8f8f8;padding:10px}#user-sefeset-container .content-container>section{font-size:13px;color:#333;margin-bottom:25px}#user-sefeset-container .content-container>section:last-of-type{margin-bottom:0}#user-sefeset-container .content-container>section>*{display:inline-block;vertical-align:top}#user-sefeset-container .content-container>section>i{padding-top:5px;width:7em;text-align:right}#user-sefeset-container .content-container>section>div{margin-left:20px}#user-sefeset-container .content-container>section>div>div{margin-top:5px;color:#666}","",{version:3,sources:["/home/zhaoyicheng/devspace/admin_ui/assets/src/views/base/mine/SafeSet.vue"],names:[],mappings:"AACA,yCAAyC,mBAAmB,YAAY,CACvE,AACD,mDAAmD,eAAe,WAAW,kBAAkB,CAC9F,AACD,gEAAgE,eAAe,CAC9E,AACD,qDAAqD,qBAAqB,kBAAkB,CAC3F,AACD,qDAAqD,gBAAgB,UAAU,gBAAgB,CAC9F,AACD,uDAAuD,gBAAgB,CACtE,AACD,2DAA2D,eAAe,UAAU,CACnF",file:"SafeSet.vue",sourcesContent:["\n#user-sefeset-container .el-card__header{background:#f8f8f8;padding:10px\n}\n#user-sefeset-container .content-container>section{font-size:13px;color:#333;margin-bottom:25px\n}\n#user-sefeset-container .content-container>section:last-of-type{margin-bottom:0\n}\n#user-sefeset-container .content-container>section>*{display:inline-block;vertical-align:top\n}\n#user-sefeset-container .content-container>section>i{padding-top:5px;width:7em;text-align:right\n}\n#user-sefeset-container .content-container>section>div{margin-left:20px\n}\n#user-sefeset-container .content-container>section>div>div{margin-top:5px;color:#666\n}\n"],sourceRoot:""}])},398:function(e,t,n){var a=n(346);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n(139)("b2b4eeac",a,!0)},461:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("article",{attrs:{id:"user-sefeset-container"}},[n("el-card",{staticClass:"box-card"},[n("div",{staticClass:"clearfix",slot:"header"},[n("span",[e._v("二次验证")])]),e._v(" "),n("article",{staticClass:"content-container"},[n("section",[n("i",[n("el-tag",{attrs:{type:"danger"}},[e._v("推荐")]),e._v("\n                    微信:")],1),e._v(" "),n("div",[e.wechat&&e.wechat.data?n("span",[n("el-tag",{attrs:{type:"primary"}},[e._v("已绑定微信号: "+e._s(e.wechat.data))]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.changeWechat}},[e._v("更换")])],1):n("span",[n("el-tag",{attrs:{type:"gray"}},[e._v("未绑定")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.bindWechat}},[e._v("绑定")])],1),e._v(" "),n("div",[e._v("绑定后，登录医线通平台可用绑定微信账号扫码进行安全验证。")])])]),e._v(" "),n("section",[n("i",[e._v("手机号码:")]),e._v(" "),n("div",[e.sms&&e.sms.data?n("span",[n("el-tag",{attrs:{type:"primary"}},[e._v("已绑定手机号码: "+e._s(e.sms.data))]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.changeSms}},[e._v("更换")])],1):n("span",[n("el-tag",{attrs:{type:"gray"}},[e._v("未绑定")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.bindSms}},[e._v("绑定")])],1),e._v(" "),n("div",[e._v("绑定后，登录医线通平台用该手机号码接收登录验证码。")])])]),e._v(" "),n("section",[n("i",[e._v("电子邮件:")]),e._v(" "),n("div",[e.email&&e.email.data?n("span",[n("el-tag",{attrs:{type:"primary"}},[e._v("已绑定电子邮箱: "+e._s(e.email.data))]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.changeEmail}},[e._v("更换")])],1):n("span",[n("el-tag",{attrs:{type:"gray"}},[e._v("未绑定")]),e._v(" "),n("el-button",{attrs:{type:"text"},on:{click:e.bindEmail}},[e._v("绑定")])],1),e._v(" "),n("div",[e._v("绑定后，登录医线通平台可用该邮箱接收登录验证码。")])])])])]),e._v(" "),n("el-dialog",{attrs:{title:"绑定",size:"tiny"},model:{value:e.dialogBind.isShow,callback:function(t){e.dialogBind.isShow=t},expression:"dialogBind.isShow"}},[n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"email"==e.fetchParam.type?"电子邮箱":"手机号码"}},[n("el-input",{attrs:{"auto-complete":"off",placeholder:"email"==e.fetchParam.type?"请输入邮箱地址":"请输入手机号码"},model:{value:e.fetchParam.receiver,callback:function(t){e.fetchParam.receiver=t},expression:"fetchParam.receiver"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"验证码"}},[n("div",{staticStyle:{display:"inline-block",width:"56%","vertical-align":"top"}},[n("el-input",{attrs:{placeholder:"输入验证码"},model:{value:e.fetchParam.code,callback:function(t){e.fetchParam.code=t},expression:"fetchParam.code"}})],1),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:e.dialogBind.validWait>0},on:{click:e.sendBindValidCode}},[e.dialogBind.validWait<=0?n("i",[e._v("发送验证码")]):n("i",[e._v(e._s(e.dialogBind.validWait)+" 秒后重发")])])],1),e._v(" "),n("el-form-item",{attrs:{label:""}},[n("el-button",{attrs:{type:"primary"},on:{click:e.bindFn}},[n("i",[e._v("确定")])])],1)],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"更换绑定",size:"tiny"},model:{value:e.dialogChange.isShow,callback:function(t){e.dialogChange.isShow=t},expression:"dialogChange.isShow"}},[n("el-form",{attrs:{"label-width":"80px"}},[n("el-form-item",{attrs:{label:"验证方式"}},[n("i",[e._v(e._s(("email"==e.fetchParam.type?"电子邮箱":"手机号码")+" ("+e.fetchParam.receiver+")"))])]),e._v(" "),n("el-form-item",{attrs:{label:"验证码"}},[n("div",{staticStyle:{display:"inline-block",width:"60%","vertical-align":"top"}},[n("el-input",{attrs:{placeholder:"输入验证码"},model:{value:e.fetchParam.code,callback:function(t){e.fetchParam.code=t},expression:"fetchParam.code"}})],1),e._v(" "),n("el-button",{attrs:{type:"primary",disabled:e.dialogBind.validWait>0},on:{click:e.sendBindValidCode}},[e.dialogBind.validWait<=0?n("i",[e._v("发送验证码")]):n("i",[e._v(e._s(e.dialogBind.validWait)+" 秒后重发")])])],1),e._v(" "),n("el-form-item",{attrs:{label:""}},[n("el-button",{attrs:{type:"primary"},on:{click:e.validCode}},[n("i",[e._v("确定")])])],1)],1),e._v(" "),n("span",{slot:"footer"},[e._v("\n            如果您已绑定"+e._s("email"==e.fetchParam.type?"电子邮箱":"手机号码")+"无法接收验证码，请联系我们：400-686-5262\n        ")])],1)],1)},staticRenderFns:[]}}});
//# sourceMappingURL=41.0e853bcb2a99c87eefdd.js.map